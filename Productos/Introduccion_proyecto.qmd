---
title: "Desarrollo de la demografía de Corea del Sur durante 2000-2022 "
format: html
editor: visual
author: "Javiera Rojas"
lang: es
theme: litera
title-block-author-single: "Autora"
---

# Introducción

Hoy algunos países del mundo son mucho más relevantes que sobre otros por tener aspectos como una gran dimensión territorial, poder económico y político y su organización sobre la sociedad. Una pieza del mundo que dispone con estas características y resalta es el continente asiático, que cuenta con, además de lo anterior, con avances tecnológicos y donde los habitantes se ve influenciados beneficiosamente por esto sin perder sus raíces antiguas. Un país a destacar que pertenece a este territorio y de gran importancia corresponde a Corea del Sur, que se puede calificar como un país con gran cantidad de habitantes, culturalmente conservador y con una gran economía actualmente. Pero si retrocedemos un par de años, esta potencia mundial era totalmente distinta a la que conocemos, pues no poseía un buen lugar en el ranking del PIB, no era un gran exportador y ni consumidor que llamara la atención, por lo que ha tenido una gran evolución en poco tiempo a un país desarrollado.\
\
Como vemos hoy su economía afecta con gran poder al mundo y que a media del paso de los años su influencia ha tomado gran valor; sin embargo, ahora sería interesante ver como ha evolucionado de manera social este país, ósea no solo en temas de su economía sino demográficos. Es por esto que nos plantearíamos las siguientes preguntas: ¿Qué ha pasado con la población en los últimos 20 años? ¿Han existido otros hechos que han provocado efectos en los nacimientos o muertes? ¿Los eventos dentro de un país influyen en la toma de decisiones como el casarse?. Es por esto que en este proyecto se abordará el responder estas preguntas a través de datos que nos ayudarán y completarán el saber si existen patrones que se han presentado en el último año. Donde con los resultados de las variables podemos interpretar como un hecho histórico afecta en la sociedad de un país.\
\
Con lo dicho anteriormente, los datos que se trabajará son de origen de una base de datos de la demografía de Corea del Sur, que almacena variables relativas a como han evolucionado por ciudad, algunos aspectos como el número de muertes, nacimientos, divorcios en los últimos 22 años, enfocándonos en cinco ciudades del país(las con más densidad poblacional). Con tal de identificar patrones demográficos de este país que han ocurrido, con tal descubrir si existe algún fenómeno que hayan afectado o provocaron desequilibrio en los patrones normales. Por ejemplo, se sabe que en 2001 se vio alterada la densidad por inmigración de habitantes de Corea del Norte, por lo que desde ahí hasta el 2022 es probable e interesante saber qué ha ocurrido luego de este hecho y como ha cambiado la densidad del país.\
\
El objetivo de este proyecto es el conocer cómo se comporta la sociedad dentro de un amplio período de tiempo y cómo ha evolucionado la demografía de este, enfocándonos en una potencia mundial como Corea. Donde luego de ver y obtener resultados a través de representaciones del comportamiento de las distintas variables, se analizaran el contexto histórico donde ocurrieron algunos patrones de estas.\
\
Este trabajo está dividido en cuatro secciones. En la primera se entregará contexto respecto a Corea del sur y el interés de su evolución demográfica en los últimos años. En segundo lugar, se describirán datos y variables para el análisis del trabajo. Luego, en la tercera se dará un análisis descriptivo de los patrones de las variables de interés contenidas en la base de datos y por último, en la cuarta sección se interpretarán los patrones o resultados de la sección anterior en función de fenómenos históricos que ocurrieron en el periodo que cubre la base de datos que ocuparemos.

# Desarrollo

## Base de datos

Como se mencionó anteriormente los recursos y proceso de este proyecto, junto con esto, a continuación se presentara una breve tabla descriptiva de las variables que contiene esta base de datos con la que se trabajara en las etapas del estudio.

```{r,echo=FALSE,include=FALSE}
library(readr)
library(dplyr)
library(ggplot2)
library(forcats) 
library(tidyverse) 
library(stringr)   
library(rebus) 
library(gt)
library(gtsummary)
datos_demografia <- read_csv("/Users/javie/OneDrive/Escritorio/Proyecto/Datos/Korean_demographics_2000-2022.csv")
```

```{r, echo=FALSE}

desp <- datos_demografia[1:13] 
data.frame(Variables = names(desp), 
           Tipo = c(class(desp$Fecha),
                    class(desp$Region),
                    class(desp$Nacimientos),
                    class(desp$Tasa_de_nacimientos),
                    class(desp$Fallecimientos),
                    class(desp$Tasa_de_Fallecimientos),
                    class(desp$Divorcios),
                    class(desp$Tasa_de_divorcios),
                    class(desp$Casamientos),
                    class(desp$Tasa_de_casamientos),
                    class(desp$Crecimiento_natural),
                    class(desp$Tasa_de_crecimiento_natural),
                    class(desp$Año)),
           Descripción = c("Indicación del año, mes y día en que se registraron los datos",
                           "Ciudad de Corea del Sur",
                           "Cantidad de recien nacidos",
                           "Número de nacimientos por cada mil habitantes en un año",
                           "Cantidad de muertes",
                           "Número de muertes por cada mil habitantes en un año ",
                           "Cantidad de disolución legal de un matrimonio",
                           "Número de divorcios por cada mil habitantes durante un año",
                           "Cantidad de uniones de dos personas mediante  formalidades legales",
                           "Número de casamientos por cada mil habitantes durante un año",
                           "Diferencia entre el número de nacimientos y el número de defunciones de una población en un determinado tiempo",
                           "Es el crecimiento o disminución natural expresado en términos relativos al tamaño de la población",
                           "Corresponde al año de la fecha en que se registraron los datos") )%>%
  gt()%>%
  tab_header(title = "Descripción de variables a trabajar")
```

Como podemos ver tenemos distintas variables donde en su mayoría son de tipo numérico, pues nos enfocaremos en las tasas y el año de cada registro.

## Gráficos y tablas

Ya presentadas las variables con las que trabajaremos, ahora se expondran a traves de graficos y una tabla la evolucion de las variabels de interes durante los año 2000 hasta 2022. Para esto nos enfocaremso en as tasas, lo que quire decir que a continaicion prsentaremos cinco graficos donde cada uno presentara el progreso promedio de cada año en las ciudades o regiones con mayor poblacion del pais a trabajar las cuales son: Busan, Seúl, Incheon, Daegu y Daejeon.

Como se dijio veremos la evolucion promedio de cada variable a taves de su tasa, como podemos ver la figura 1:

###### Grafico 1

```{r,echo=FALSE,warning=FALSE}
S <-datos_demografia %>% 
  filter(Region %in% "Seoul" ) %>% 
  aggregate(Tasa_de_nacimientos~Año, FUN = mean)

S$Region = rep("Seoul",23)

b <-datos_demografia %>% 
  filter(Region %in% "Busan" ) %>% 
  aggregate(Tasa_de_nacimientos~Año, FUN = mean)

b$Region = rep("Busan",23)

i <-datos_demografia %>% 
  filter(Region %in% "Incheon" ) %>% 
  aggregate(Tasa_de_nacimientos~Año , FUN = mean)

i$Region = rep("Incheon",23)

d <-datos_demografia %>% 
  filter(Region %in% "Daegu" ) %>% 
  aggregate(Tasa_de_nacimientos~Año, FUN = mean)
  
d$Region = rep("Daegu",23)


d2<-datos_demografia %>% 
  filter(Region %in% "Daejeon" ) %>% 
  aggregate(Tasa_de_nacimientos~Año, FUN = mean)
d2$Region = rep("Daejeon",23)

datos2<-rbind(S,b,i,d,d2)
datos2<-data.frame(datos2)


#grafico
paises <-c("Seoul" = "#052F61" ,  "Busan" = "#CE6633"  , "Incheon" = "#A50E82", "Daegu" = "#6A9E1F","Daejeon" = "#E87D37" )

datos2|>
  filter(Region %in% c("Seoul" ,  "Busan"  , "Incheon", 
                       "Daegu" ,  "Daejeon" ))|>
  ggplot(aes(x = Año, y= Tasa_de_nacimientos,color = Region))+
  labs(title="Evolución de tasas de nacimientos en regiones de Corea del Sur durante 2000-2022",x = NULL,
       y = "Valor tasa",subtitle = "Comparación de  tasas en las regiones Seoul, Busan, Incheon, Daegu, Daejeon",caption = "Fuente: elaboración propia a partir de datos disponibles en Kaggle")+
  scale_x_continuous(breaks = seq("2000", "2022", by = 2)) +
  ylim(c(0,14)) + 
  geom_line( size = 1)+
  geom_vline(xintercept = c(c(2000,2002),c(2016,2020)),color = "red", linetype="dashed",size = 0.5)+
  geom_point(size = 2) +
  theme(axis.text.x = element_text(angle = 0),legend.position = "bottom")+
  scale_color_manual(values = paises) 

```

Al observar le grafico podemos darnos cuenta de que no existe en general un equilibrio de la tasa de nacimiento, pero si se puede decir globalmente que en ambas regiones se presentan las mismas tendencias: aumentan en los mismos años y lo mismo sucede cuando disminuye esta tasa. Si nos fijamos entre 2001 y 2002 existe una disminución de la tasa de nacimientos pues se puede esperar esto por la lucha o guerra contra el terrorismo. Al igual que la disminución entre 2016 a 2020 esto se puede atribuir a cronológicamente a primero en 2016 ocurrió una crisis política a causa de la mandataria, luego de esto comenzó la tensión entre EE. UU. y corea del norte debido a la tensión entre sus presidentes por la supuesta guerra nuclear que se especulaba y la pandemia que comenzó en 2019, lo cual se puede predecir que las personas en consecuencia de circunstancias de incertidumbre sobre el futuro provocara que menos mujeres se sientan inseguras para ser madres.

###### Grafico 2

```{r,echo=FALSE,warning=FALSE}
S3 <-datos_demografia %>% 
  filter(Region %in% "Seoul" ) %>% 
  aggregate(Tasa_de_Fallecimientos~Año, FUN = mean)

S3$Region = rep("Seoul",23)

b3 <-datos_demografia %>% 
  filter(Region %in% "Busan" ) %>% 
  aggregate(Tasa_de_Fallecimientos~Año, FUN = mean)

b3$Region = rep("Busan",23)

i3 <-datos_demografia %>% 
  filter(Region %in% "Incheon" ) %>% 
  aggregate(Tasa_de_Fallecimientos~Año , FUN = mean)

i3$Region = rep("Incheon",23)

d3 <-datos_demografia %>% 
  filter(Region %in% "Daegu" ) %>% 
  aggregate(Tasa_de_Fallecimientos~Año, FUN = mean)

d3$Region = rep("Daegu",23)

d23<-datos_demografia %>% 
  filter(Region %in% "Daejeon" ) %>% 
  aggregate(Tasa_de_Fallecimientos~Año, FUN = mean)
d23$Region = rep("Daejeon",23)

datos3<-rbind(S3,b3,i3,d3,d23)
datos3<-data.frame(datos3)



#grafico
paises <-c("Seoul" = "#052F61" ,  "Busan" = "#CE6633"  , "Incheon" = "#A50E82", "Daegu" = "#6A9E1F","Daejeon" = "#E87D37" )

datos3|>
  filter(Region %in% c("Seoul" ,  "Busan"  , "Incheon", 
                       "Daegu" ,  "Daejeon" ))|>
  ggplot(aes(x = Año, y= Tasa_de_Fallecimientos,color = Region))+
  labs(title="Evolución de tasas de fallecimientos en regiones de Corea del Sur durante 2000-2022",x = NULL,
       y = "Valor tasa",subtitle = "Comparación de  tasas en las regiones Seoul, Busan, Incheon, Daegu, Daejeon",caption = "Fuente: elaboración propia a partir de datos disponibles en Kaggle")+
  scale_x_continuous(breaks = seq("2000", "2022", by = 2)) +
  ylim(c(0,10)) + 
  geom_line( size = 1)+
  geom_point(size = 2) +
  theme(axis.text.x = element_text(angle = 0),legend.position = "bottom")+
  scale_color_manual(values = paises) 
```

###### Grafico 3

```{r,echo=FALSE,warning=FALSE}
S4 <-datos_demografia %>% 
  filter(Region %in% "Seoul" ) %>% 
  aggregate(Tasa_de_divorcios~Año, FUN = mean)

S4$Region = rep("Seoul",23)

b4 <-datos_demografia %>% 
  filter(Region %in% "Busan" ) %>% 
  aggregate(Tasa_de_divorcios~Año, FUN = mean)

b4$Region = rep("Busan",23)

i4 <-datos_demografia %>% 
  filter(Region %in% "Incheon" ) %>% 
  aggregate(Tasa_de_divorcios~Año , FUN = mean)

i4$Region = rep("Incheon",23)

d4 <-datos_demografia %>% 
  filter(Region %in% "Daegu" ) %>% 
  aggregate(Tasa_de_divorcios~Año, FUN = mean)

d4$Region = rep("Daegu",23)

d24<-datos_demografia %>% 
  filter(Region %in% "Daejeon" ) %>% 
  aggregate(Tasa_de_divorcios~Año, FUN = mean)
d24$Region = rep("Daejeon",23)

datos4<-rbind(S4,b4,i4,d4,d24)
datos4<-data.frame(datos4)



#grafico
paises <-c("Seoul" = "#052F61" ,  "Busan" = "#CE6633"  , "Incheon" = "#A50E82", "Daegu" = "#6A9E1F","Daejeon" = "#E87D37" )

datos4|>
  filter(Region %in% c("Seoul" ,  "Busan"  , "Incheon", 
                       "Daegu" ,  "Daejeon" ))|>
  ggplot(aes(x = Año, y= Tasa_de_divorcios,color = Region))+
  labs(title="Evolución de tasas de divorcios en regiones de Corea del Sur durante 2000-2022",x = NULL,
       y = "Valor tasa",subtitle = "Comparación de  tasas en las regiones Seoul, Busan, Incheon, Daegu, Daejeon",caption = "Fuente: elaboración propia a partir de datos disponibles en Kaggle")+
  scale_x_continuous(breaks = seq("2000", "2022", by = 2)) +
  ylim(c(0,5)) + 
  geom_line( size = 1)+
  geom_point(size = 2) +
  theme(axis.text.x = element_text(angle = 0),legend.position = "bottom")+
  scale_color_manual(values = paises) 
```

###### Grafico 4

```{r,echo=FALSE,warning=FALSE}
S5 <-datos_demografia %>% 
  filter(Region %in% "Seoul" ) %>% 
  aggregate(Tasa_de_casamientos~Año, FUN = mean)

S5$Region = rep("Seoul",23)

b5 <-datos_demografia %>% 
  filter(Region %in% "Busan" ) %>% 
  aggregate(Tasa_de_casamientos~Año, FUN = mean)

b5$Region = rep("Busan",23)

i5 <-datos_demografia %>% 
  filter(Region %in% "Incheon" ) %>% 
  aggregate(Tasa_de_casamientos~Año , FUN = mean)

i5$Region = rep("Incheon",23)

d5 <-datos_demografia %>% 
  filter(Region %in% "Daegu" ) %>% 
  aggregate(Tasa_de_casamientos~Año, FUN = mean)

d5$Region = rep("Daegu",23)


d25<-datos_demografia %>% 
  filter(Region %in% "Daejeon" ) %>% 
  aggregate(Tasa_de_casamientos~Año, FUN = mean)
d25$Region = rep("Daejeon",23)

datos5<-rbind(S5,b5,i5,d5,d25)
datos5<-data.frame(datos5)


#grafico
paises <-c("Seoul" = "#052F61" ,  "Busan" = "#CE6633"  , "Incheon" = "#A50E82", "Daegu" = "#6A9E1F","Daejeon" = "#E87D37" )

datos5|>
  filter(Region %in% c("Seoul" ,  "Busan"  , "Incheon", 
                       "Daegu" ,  "Daejeon" ))|>
  ggplot(aes(x = Año, y= Tasa_de_casamientos,color = Region))+
  labs(title="Evolución de tasas de casamientos en regiones de Corea del Sur durante 2000-2022",x = NULL,y = "Valor tasa",subtitle = "Comparación de  tasas en las regiones Seoul, Busan, Incheon, Daegu, Daejeon",caption = "Fuente: elaboración propia a partir de datos disponibles en Kaggle")+
  scale_x_continuous(breaks = seq("2000", "2022", by = 2)) +
  ylim(c(0,8)) + 
  geom_line( size = 1)+
  geom_point(size = 2) +
  theme(axis.text.x = element_text(angle = 0),legend.position = "bottom")+
  scale_color_manual(values = paises) 
```

###### Grafico 5

```{r,echo=FALSE,warning=FALSE}
S6 <-datos_demografia %>% 
  filter(Region %in% "Seoul" ) %>% 
  aggregate(Tasa_de_crecimiento_natural~Año, FUN = mean)

S6$Region = rep("Seoul",23)

b6 <-datos_demografia %>% 
  filter(Region %in% "Busan" ) %>% 
  aggregate(Tasa_de_crecimiento_natural~Año, FUN = mean)

b6$Region = rep("Busan",23)

i6 <-datos_demografia %>% 
  filter(Region %in% "Incheon" ) %>% 
  aggregate(Tasa_de_crecimiento_natural~Año , FUN = mean)

i6$Region = rep("Incheon",23)

d6 <-datos_demografia %>% 
  filter(Region %in% "Daegu" ) %>% 
  aggregate(Tasa_de_crecimiento_natural~Año, FUN = mean)

d6$Region = rep("Daegu",23)

d26<-datos_demografia %>% 
  filter(Region %in% "Daejeon" ) %>% 
  aggregate(Tasa_de_crecimiento_natural~Año, FUN = mean)
d26$Region = rep("Daejeon",23)

datos6<-rbind(S6,b6,i6,d6,d26)
datos6<-data.frame(datos6)



#grafico
paises <-c("Seoul" = "#052F61" ,  "Busan" = "#CE6633"  , "Incheon" = "#A50E82", "Daegu" = "#6A9E1F","Daejeon" = "#E87D37" )

datos6|>
  filter(Region %in% c("Seoul" ,  "Busan"  , "Incheon", 
                       "Daegu" ,  "Daejeon" ))|>
  ggplot(aes(x = Año, y= Tasa_de_crecimiento_natural,color = Region))+
  labs(title="Evolución de tasas de crecimiento natural en regiones de Corea del Sur durante 2000-2022",x = NULL,y = "Valor tasa",subtitle = "Comparación de  tasas en las regiones Seoul, Busan, Incheon, Daegu, Daejeon",caption = "Fuente: elaboración propia a partir de datos disponibles en Kaggle")+
  scale_x_continuous(breaks = seq("2000", "2022", by = 2)) +
  ylim(c(-10,12)) + 
  geom_line( size = 1)+
  geom_point(size = 2) +
  theme(axis.text.x = element_text(angle = 0),legend.position = "bottom")+
  scale_color_manual(values = paises) 
```

\

Como vimos anterioremente se puede ver un analisis durante los ultimos 22 años sobre que a pasado en al demografia de Corea y su variacion, pero ¿Como se vio afectado este pais socialmente duante la pandemia?¿Habra afectado como lo hizo en otros paises con los numero sde naciemeientos y muertes?. Para responder esta pregunta mostraremso una tabla que incluye el promedio de cada una de las tasas en el correspondiente año por cada region de Corea.

```{r,echo=FALSE}
inicio <- "2019"
final <- "2022"

# juntar datos entre los años

  
datosf <- cbind(datos2,datos3[2],datos4[2],datos5[2],datos6[2])
datosf <- data.frame(datosf)

datosf%>%
  filter(Año >= inicio & Año <= final)%>%
  gt(groupname_col = "Region",rowname_col = "Año") %>%
  tab_header(title = "Tasas durante la pandemia en regiones de Corea del Sur")%>%
  #tab_row_group(label = "Region")
  fmt_number(columns = Año,decimals = 0,use_seps = FALSE)%>%
  tab_options(row_group.background.color = "#F8BBD0") %>%
  tab_spanner(label = "Tasas",columns = c("Tasa_de_nacimientos",
                                          "Tasa_de_Fallecimientos",
                                          "Tasa_de_divorcios",
                                          "Tasa_de_casamientos",
                                          "Tasa_de_crecimiento_natural"))
```
